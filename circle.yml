machine:
  python:
    version: 2.7.3
  services:
    - docker

dependencies:
  pre:
    - pip install awscli
    - docker build -t kand/$CIRCLE_PROJECT_REPONAME:$CIRCLE_SHA1 -f ./resources/docker/Dockerfile .

test:
  override:
    - echo True

deployment:
  elasticbeanstalk:
    branch: feature/docker-circleci
    commands:
      - docker login -p $DOCKER_PASSWORD -u $DOCKER_USERNAME -e $DOCKER_EMAIL
      - docker push kand/$CIRCLE_PROJECT_REPONAME:$CIRCLE_SHA1
      - ./deploy-docker.sh $CIRCLE_SHA1
