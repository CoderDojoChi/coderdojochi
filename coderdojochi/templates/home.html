{% extends "_base.html" %}

{% load staticfiles i18n coderdojochi_extras %}

{% block notitle %}CoderDojoChi{% endblock %}

{% block body_class %}page-homepage{% endblock %}

{% block content %}
<div class="hero">
    <div class="container">
        <div id="carousel-home-hero" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                    <div class="flex-video widescreen" style="margin: 0 auto;text-align:center;">
                        <iframe id="homepage-video" src="//www.youtube.com/embed/s23D25cOREk?controls=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
                    </div>
                </div>
{% comment %}
                <div class="item">
                    <div class="flex-video vimeo" style="margin: 0 auto;text-align:center;">
                        <iframe src="//player.vimeo.com/video/108196950?title=0&amp;byline=0&amp;portrait=0&amp;autoplay=1" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                    </div>
                </div>
{% endcomment %}
            </div>
        </div>
    </div>
</div>

{% if upcoming_classes %}
<div class="upcoming-sessions">
    {% for session in upcoming_classes %}
        <div class="upcoming-session" style="background-image: url(/static/images/{{ session.image_url }});">
            <div class="session-shim">
                <div class="container">
                    <div class="date">
                        {{ session.start_date|date:'F' }}
                        <span class="day">{{ session.start_date|date:'d' }}</span>
                    </div>
                    <div class="description">
                        <h4 class="title">{{ session.course.title }}:</h4>
                        <p>{{ session.course.description|safe|truncatechars:180 }} <a href="{{ session.get_absolute_url }}">Learn more.</a></p>
                    </div>
                    <div class="actions">
                        {% if session.capacity|subtract:session.get_current_students.all.count %}
                        <a href="{{ session.get_absolute_url }}?enroll=True" class="btn-cdc btn-cdc">Enroll Now</a>
                        {% else %}
                        <button class="btn-cdc btn-cdc disabled" disabled>Class is full</button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
</div>
{% endif %}

<div class="container">
    <div class="row block-cta">
        <div class="homepage-volunteer half">
            <a class="homepage-action" href="{% url 'volunteer' %}">
                <span class="icon-volunteer fa fa-fw fa-group"></span>
            </a>
            <h1>Volunteer</h1>
            <!-- <p>If you are passionate about coding and teaching children, join us. Everyone is welcome, regardless of technical ability. We are a collective of teachers, writers, coders, designers, crafters, nurturers, hackers, leaders, and tinkers.</p> -->

            <p>We're looking for people who believe they can make a difference by exposing the youth to the world of coding.</p>
        </div>
        <div class="homepage-donate half">
            <a class="homepage-action" href="{% url 'donate' %}">
                <span class="icon-donation fa fa-fw"></span>
            </a>
            <h1>Donate</h1>
            <p>Funding goes 100% towards equipment and food for youth, attendees, and mentors.</p>
        </div>
    </div>
</div>

{% endblock %}


{% block extra_script %}

<script>

// This code loads the IFrame Player API code asynchronously
var tag = document.createElement('script');
tag.src = "http://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);


// This code is called by the YouTube API to create the player object
function onYouTubeIframeAPIReady(event) {
  player = new YT.Player('homepage-video', {
    events: {
      'onStateChange': onPlayerStateChange
    }
  });
}

var pauseFlag = false;

function onPlayerStateChange(event) {
    // track when user clicks to Play
    if (event.data == YT.PlayerState.PLAYING) {
        _gaq.push(['_trackEvent', 'Videos', 'Play', 'Homepage Video']);
        pauseFlag = true;
    }
    // track when user clicks to Pause
    if (event.data == YT.PlayerState.PAUSED && pauseFlag) {
        _gaq.push(['_trackEvent', 'Videos', 'Pause', 'Homepage Video']);
        pauseFlag = false;
    }
    // track when video ends
    if (event.data == YT.PlayerState.ENDED) {
        _gaq.push(['_trackEvent', 'Videos', 'Finished', 'Homepage Video']);
    }
}

</script>



{% endblock %}
