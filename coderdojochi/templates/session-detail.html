{% extends "_base.html" %}

{% load i18n avatar_tags %}

{% block title %}{% if session.course.code %}{{ session.course.code }} | {% endif %}{{ session.course.title }}{% endblock %}

{% block body_class %}class-detail{% endblock %}

{% block content %}
<div class="container">
    <h1 class="light">{% if session.course.code %}<small>{{ session.course.code }}:</small> {% endif %}{{ session.course.title }} <small><i class="fa fa-clock-o"></i> {{ session.start_date|date }} from {{ session.start_date|time }} to {{ session.end_date|time }}</small></h1>
    <div class="row">
        <div class="class-detail-content">
            <p class="lead drop-caps">{{ session.course.description|safe }}</p>
            <h2>Class Information</h2>
            <h4>When:</h4>
            <p>{{ session.start_date|date }} from {{ session.start_date|time }} to {{ session.end_date|time }}</p>
            <h4>Where:</h4>
            <p>{{ session.location }}</p>
            {% if session.additional_info %}
            <h4>Additional Info:</h4>
            <p>{{ session.additional_info|safe }}</p>
            {% endif %}
        </div>
        <div class="class-detail-sidebar-right">
            <div id="sign-up" class="well">
                {% if user_signed_up %}
                    <h2>You are signed up for this class!</h2>
                    <p>Logged in as {{ user.role }} <i>{% avatar user 25 %}</i> <strong>{{ user.username }}</strong>. <a href="{% url 'auth_logout' %}?next={% url 'session_detail' session.start_date.year session.start_date.month session.start_date.day session.course.slug %}">Logout.</a></p>
                    <p><a href="{% url 'session_sign_up' session.start_date.year session.start_date.month session.start_date.day session.course.slug %}" class="btn btn-danger btn-sm">Oops! I can't make it...</a></p>
                {% else %}
                    <h2>Sign up</h2>
                    {% if user.is_authenticated %}
                    <p>Logged in as {{ user.role }} <i>{% avatar user 25 %}</i> <strong>{{ user.username }}</strong>. <a href="{% url 'auth_logout' %}?next={% url 'session_detail' session.start_date.year session.start_date.month session.start_date.day session.course.slug %}">Logout.</a></p>
                    <p><a href="{% url 'session_sign_up' session.start_date.year session.start_date.month session.start_date.day session.course.slug %}" class="btn btn-success btn-lg">Sign up {% ifequal user.role 'mentor'%}to mentor{% else %}for this class{% endifequal %} now!</a></p>
                    {% else %}
                    <p><a href="{% url 'auth_login' %}?next={% url 'session_detail' session.start_date.year session.start_date.month session.start_date.day session.course.slug %}">Login</a> or <a href="{% url 'registration_register' %}">register</a> to sign up for this session.</p>
                    {% endif %}
                {% endif %}
            </div>
            <a target="_blank" class="map" href="https://www.google.com/maps/preview?q={{ session.location }}"><img src="http://maps.google.com/maps/api/staticmap?markers=location:+{{ session.location }}&amp;size=500x500&amp;sensor=false"></a>
            <p class="text-center"><a target="_blank" href="https://www.google.com/maps/preview?q={{ session.location }}">Open in Google Maps</a></p>
        </div>
    </div>

    <h2>Teacher</h2>
    <div class="mentors">
        <div class="mentor">
            {% avatar session.teacher.user %}
            <div class="info">
                <h3 class="title">{{ session.teacher.first_name }} {{ session.teacher.last_name }}</h4>
                <p>{{ session.teacher.bio }}</p>
            </div>
        </div>
    </div>

    {% if session.mentors.all %}
    <h2>Mentors</h2>
    <div class="mentors">
        {% for mentor in session.mentors.all %}
        <div class="mentor">
            {% avatar mentor.user %}
            <div class="info">
                <h3 class="title">{{ mentor.first_name }} {{ mentor.last_name }}</h3>
                <p>{{ mentor.bio }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

</div>
{% endblock %}
